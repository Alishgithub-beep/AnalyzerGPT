import pandas as pd
import numpy as np

# Load the data
try:
    df = pd.read_csv('data.csv')
    print("Data loaded successfully!")
    
    # Basic information about the dataset
    print(f"\nDataset Shape: {df.shape}")
    print(f"\nColumns: {list(df.columns)}")
    
    print("\n" + "="*50)
    print("DATA TYPES:")
    print("="*50)
    print(df.dtypes)
    
    print("\n" + "="*50)
    print("SUMMARY STATISTICS FOR NUMERICAL COLUMNS:")
    print("="*50)
    numerical_cols = df.select_dtypes(include=[np.number]).columns
    if len(numerical_cols) > 0:
        print(df[numerical_cols].describe())
    else:
        print("No numerical columns found")
    
    print("\n" + "="*50)
    print("CATEGORICAL COLUMNS ANALYSIS:")
    print("="*50)
    categorical_cols = df.select_dtypes(include=['object']).columns
    if len(categorical_cols) > 0:
        for col in categorical_cols:
            print(f"\nColumn: {col}")
            print(f"Unique values: {df[col].nunique()}")
            print(f"Most frequent value: {df[col].mode().iloc[0] if len(df[col].mode()) > 0 else 'N/A'}")
            print(f"Frequency of top value: {df[col].value_counts().iloc[0] if len(df[col].value_counts()) > 0 else 0}")
    else:
        print("No categorical columns found")
    
    print("\n" + "="*50)
    print("MISSING VALUES ANALYSIS:")
    print("="*50)
    missing_values = df.isnull().sum()
    if missing_values.sum() > 0:
        print("Missing values per column:")
        for col, count in missing_values.items():
            if count > 0:
                print(f"{col}: {count} missing values ({count/len(df)*100:.2f}%)")
    else:
        print("No missing values found in the dataset")
    
    print("\n" + "="*50)
    print("BASIC ANALYTICS COMPLETED:")
    print("="*50)
    print(f"Total records: {len(df)}")
    print(f"Total columns: {len(df.columns)}")
    print(f"Numerical columns: {len(numerical_cols)}")
    print(f"Categorical columns: {len(categorical_cols)}")
    print(f"Total missing values: {df.isnull().sum().sum()}")
    
except FileNotFoundError:
    print("Error: data.csv file not found in the working directory")
except Exception as e:
    print(f"Error occurred: {str(e)}")
